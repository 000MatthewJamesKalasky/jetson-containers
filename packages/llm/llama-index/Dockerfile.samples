# 
# this is the llama-index:samples container (built on top of llama-index)
# see Dockerfile & config.py for package configuration/metadata
#
ARG BASE_IMAGE
FROM ${BASE_IMAGE}

RUN pip3 install --no-cache-dir --verbose llama-index-core llama-index-readers-file llama-index-llms-ollama llama-index-embeddings-huggingface

WORKDIR /opt/llama-index

COPY *.py ./
COPY *.ipynb ./
RUN sed 's|^\ \ }|    ,"notebook_dir": "/opt/llama-index"\n  }|' -i /root/.jupyter/jupyter_notebook_config.json

# CMD /bin/bash -c "/bin/ollama serve > /var/log/ollama.log && \
#   /bin/jupyter lab --ip 0.0.0.0 --port 8888 --allow-root --keyfile=/root/mycert.key --certfile=/root/mycert.pem --no-browser &> /var/log/jupyter.log" & \
# 	echo ">> jupyter lab --ip 0.0.0.0 --port 8888 --allow-root --keyfile=/root/mycert.key --certfile=/root/mycert.pem --no-browser ..." && \
# 	echo "allow 10 sec for JupyterLab to start @ http://$(hostname -I | cut -d' ' -f1):8888 (password nvidia)" && \
# 	echo "JupterLab logging location:  /var/log/jupyter.log  (inside the container)" && \
# 	/bin/bash

# CMD /bin/bash -c "/bin/ollama serve > /var/log/ollama.log && /bin/bash"

CMD /bin/bash